h1. Asset ID - Asset stamping and uploading to S3 for Rails

h2. About

Uploads static assets to Amazon S3 with unique identifiers encoded into the path of the asset. 

Only works with Rails 3.x because Rails 3 makes doing this sort of thing a lot easier and
that is all I needed it for.

This library achieves the following:

* Assets served from a cookie-less domain
* Unique identifier is not encoded into a query parameter (so it is cacheable by proxy servers)
* All assets have far-future expires headers for caching
* Assets have the Cache-Control: public header for caching
* CSS and javascript is GZipped

h2. Usage

Add the gem to your <code>Gemfile</code>

<code>gem "asset_id"</code>

Configure <code>config/environments/production.rb</code> to use Amazon S3 as the asset host
and to use the id-stamped asset paths in helpers

<pre><code>config.action_controller.asset_host = Proc.new do |source|
 'http://my_bucket.s3.amazonaws.com'
end
config.action_controller.asset_path = Proc.new do |source|
 AssetID::S3.fingerprint(source)
end
</code></pre>

Add your Amazon S3 configuration details to <code>config/asset_id.yml</code>

<pre><code>development:
  access_key_id: 'MY_ACCESS_KEY'
  secret_access_key: 'MY_ACCESS_SECRET'
  bucket: "my_dev_bucket"

production:
  access_key_id: 'MY_ACCESS_KEY'
  secret_access_key: 'MY_ACCESS_SECRET'
  bucket: "my_live_bucket"
</code></pre>

Optionally create a rake task in <code>lib/tasks/asset_id_tasks.rake</code> to
perform the upload for use in your deploy scripts

<pre><code>namespace :asset do
  namespace :id do
    
    desc "uploads the current assets to s3 with fingerprints"
    task :upload do
      AWS::S3::DEFAULT_HOST.replace "s3-eu-west-1.amazonaws.com" # If using EU bucket
      AssetID::Base.asset_paths += ['favicon.png']
      AssetID::S3.upload
    end
    
  end
end
</code></pre>
